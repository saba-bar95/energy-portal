import { useEffect, useState, useMemo } from "react";
import { useParams } from "react-router-dom";
import AnimatedNumber from "./AnimatedNumber";
import backEndUrl from "../../../fetchFunctions/backEndUrl";

const Svg1 = () => {
  return (
    <svg
      width="18"
      height="18"
      viewBox="0 0 18 18"
      fill="none"
      xmlns="http://www.w3.org/2000/svg">
      <path
        d="M17.7351 5.02696C17.5712 4.93295 17.3695 4.93376 17.2065 5.02917L11.9883 8.08073V5.48438C11.9883 5.29545 11.8872 5.12097 11.7233 5.02696C11.5594 4.93295 11.3578 4.93376 11.1947 5.02917L5.97656 8.08073V0.527344C5.97656 0.236109 5.74045 0 5.44922 0H0.527344C0.236109 0 0 0.236109 0 0.527344V17.4727C0 17.7639 0.236109 18 0.527344 18H17.4727C17.7639 18 18 17.7639 18 17.4727V5.48438C18 5.29545 17.8989 5.12097 17.7351 5.02696ZM1.05469 1.05469H4.92188V1.75781H1.05469V1.05469ZM16.9453 16.9453H1.05469V2.8125H4.92188V9C4.92188 9.40697 5.36463 9.66034 5.71542 9.4552L10.9336 6.40364V9C10.9336 9.40697 11.3764 9.66034 11.7271 9.4552L16.9453 6.40364V16.9453Z"
        fill="#007C90"
      />
      <path
        d="M7.55859 11.6543H5.44922C5.15798 11.6543 4.92188 11.8904 4.92188 12.1816V14.291C4.92188 14.5823 5.15798 14.8184 5.44922 14.8184H7.55859C7.84983 14.8184 8.08594 14.5823 8.08594 14.291V12.1816C8.08594 11.8904 7.84983 11.6543 7.55859 11.6543ZM7.03125 13.7637H5.97656V12.709H7.03125V13.7637Z"
        fill="#007C90"
      />
      <path
        d="M13.5703 11.6543H11.4609C11.1697 11.6543 10.9336 11.8904 10.9336 12.1816V14.291C10.9336 14.5823 11.1697 14.8184 11.4609 14.8184H13.5703C13.8615 14.8184 14.0977 14.5823 14.0977 14.291V12.1816C14.0977 11.8904 13.8615 11.6543 13.5703 11.6543ZM13.043 13.7637H11.9883V12.709H13.043V13.7637Z"
        fill="#007C90"
      />
    </svg>
  );
};

const Svg2 = () => {
  return (
    <svg
      width="24"
      height="18"
      viewBox="0 0 24 18"
      fill="none"
      xmlns="http://www.w3.org/2000/svg">
      <path
        d="M22.2462 13.9652V11.7692C22.2462 9.48979 21.5112 7.32318 20.1206 5.50371C18.8863 3.88865 17.1798 2.65002 15.2743 1.97557C15.2213 0.877246 14.3112 0 13.2 0H10.4308C9.31952 0 8.40946 0.877246 8.35643 1.97557C6.45102 2.65002 4.74443 3.88865 3.51014 5.50371C2.11962 7.32318 1.38462 9.48979 1.38462 11.7692V13.9652C0.578815 14.251 0 15.0205 0 15.9231C0 17.0683 0.931708 18 2.07692 18H21.5538C22.6991 18 23.6308 17.0683 23.6308 15.9231C23.6308 15.0205 23.052 14.251 22.2462 13.9652ZM2.76923 11.7692C2.76923 9.27272 3.83566 6.93563 5.58462 5.26823V7.61538C5.58462 7.99772 5.89458 8.30769 6.27692 8.30769C6.65926 8.30769 6.96923 7.99772 6.96923 7.61538V4.18232C7.40548 3.90383 7.86817 3.66088 8.35385 3.45868V9C8.35385 9.38234 8.66382 9.69231 9.04615 9.69231C9.42849 9.69231 9.73846 9.38234 9.73846 9V2.48917C9.73851 2.48728 9.73846 2.48538 9.73846 2.48349V2.07692C9.73846 1.69518 10.049 1.38462 10.4308 1.38462H13.2C13.5817 1.38462 13.8923 1.69518 13.8923 2.07692V2.48331C13.8923 2.48529 13.8923 2.48723 13.8923 2.48922V9C13.8923 9.38234 14.2023 9.69231 14.5846 9.69231C14.967 9.69231 15.2769 9.38234 15.2769 9V3.45868C15.7626 3.66092 16.2253 3.90388 16.6615 4.18232V7.61538C16.6615 7.99772 16.9715 8.30769 17.3538 8.30769C17.7362 8.30769 18.0462 7.99772 18.0462 7.61538V5.26823C19.7951 6.93563 20.8615 9.27272 20.8615 11.7692V13.8462H2.76923V11.7692ZM21.5538 16.6154H2.07692C1.69518 16.6154 1.38462 16.3048 1.38462 15.9231C1.38462 15.5413 1.69518 15.2308 2.07692 15.2308H21.5538C21.9356 15.2308 22.2462 15.5413 22.2462 15.9231C22.2462 16.3048 21.9356 16.6154 21.5538 16.6154Z"
        fill="#FF9F0A"
      />
    </svg>
  );
};

const Svg3 = () => {
  return (
    <svg
      width="23"
      height="18"
      viewBox="0 0 23 18"
      fill="none"
      xmlns="http://www.w3.org/2000/svg">
      <path
        fillRule="evenodd"
        clipRule="evenodd"
        d="M16.1997 13.8858C15.4895 13.8858 14.914 14.4613 14.914 15.1715C14.914 15.8816 15.4895 16.4572 16.1997 16.4572C16.9098 16.4572 17.4854 15.8816 17.4854 15.1715C17.4854 14.4613 16.9098 13.8858 16.1997 13.8858ZM13.3711 15.1715C13.3711 13.6093 14.6375 12.3429 16.1997 12.3429C17.7619 12.3429 19.0282 13.6093 19.0282 15.1715C19.0282 16.7337 17.7619 18 16.1997 18C14.6375 18 13.3711 16.7337 13.3711 15.1715Z"
        fill="#994C8E"
      />
      <path
        fillRule="evenodd"
        clipRule="evenodd"
        d="M5.91451 13.8858C5.20443 13.8858 4.62879 14.4613 4.62879 15.1715C4.62879 15.8816 5.20443 16.4572 5.91451 16.4572C6.62459 16.4572 7.20022 15.8816 7.20022 15.1715C7.20022 14.4613 6.62459 13.8858 5.91451 13.8858ZM3.08594 15.1715C3.08594 13.6093 4.35234 12.3429 5.91451 12.3429C7.47669 12.3429 8.74308 13.6093 8.74308 15.1715C8.74308 16.7337 7.47669 18 5.91451 18C4.35234 18 3.08594 16.7337 3.08594 15.1715Z"
        fill="#994C8E"
      />
      <path
        fillRule="evenodd"
        clipRule="evenodd"
        d="M15.0813 4.66524C14.7196 4.62943 14.2585 4.62855 13.5695 4.62855H12.5997C12.1737 4.62855 11.8283 4.28318 11.8283 3.85712C11.8283 3.43108 12.1737 3.08569 12.5997 3.08569H13.6063C14.249 3.08568 14.7867 3.08567 15.2333 3.12989C15.7063 3.17672 16.1325 3.27702 16.5428 3.50933C16.9505 3.74018 17.2623 4.05601 17.559 4.44008C17.8422 4.80679 18.1437 5.27944 18.5089 5.85202L18.5275 5.88108C19.0136 6.64321 19.5049 7.17149 20.1971 7.64628C20.2272 7.66685 20.2569 7.68721 20.2864 7.70748C20.9788 8.18165 21.5294 8.55872 21.8345 9.1808C21.992 9.50182 22.0564 9.8288 22.0861 10.1763C22.114 10.5028 22.114 10.8943 22.114 11.3527V11.4291C22.114 12.029 22.1141 12.5476 22.0635 12.9646C22.0098 13.4079 21.8884 13.8475 21.5615 14.2172C21.5375 14.2445 21.5127 14.2711 21.4872 14.2971C21.1343 14.6572 20.7031 14.7975 20.2664 14.8586C19.868 14.9144 19.3759 14.9144 18.824 14.9143H18.2568C17.8308 14.9143 17.4854 14.5689 17.4854 14.1428C17.4854 13.7168 17.8308 13.3714 18.2568 13.3714H18.7742C19.3915 13.3714 19.7739 13.3697 20.0526 13.3307C20.3051 13.2953 20.3602 13.2428 20.3852 13.2172C20.3921 13.2101 20.3989 13.2028 20.4056 13.1952C20.4377 13.1589 20.4958 13.0761 20.5318 12.779C20.5698 12.4661 20.5711 12.042 20.5711 11.3835C20.5711 10.886 20.5705 10.5607 20.5488 10.3077C20.5283 10.0682 20.4924 9.94822 20.4492 9.86007C20.3482 9.65415 20.1781 9.50419 19.3245 8.91862C18.4394 8.31156 17.8091 7.62385 17.2267 6.71079C16.8383 6.10193 16.5737 5.68846 16.3379 5.38322C16.1108 5.08914 15.9464 4.94459 15.7827 4.85194C15.6216 4.76073 15.4252 4.69929 15.0813 4.66524ZM9.25684 14.1428C9.25684 13.7168 9.60223 13.3714 10.0283 13.3714H14.1425C14.5686 13.3714 14.914 13.7168 14.914 14.1428C14.914 14.5689 14.5686 14.9143 14.1425 14.9143H10.0283C9.60223 14.9143 9.25684 14.5689 9.25684 14.1428Z"
        fill="#994C8E"
      />
      <path
        fillRule="evenodd"
        clipRule="evenodd"
        d="M11.7996 3.14108C12.1951 2.98284 12.6441 3.17525 12.8024 3.57082L13.825 6.1274C14.0818 6.76941 14.2524 7.19288 14.4184 7.50433C14.5755 7.79891 14.6952 7.92645 14.8152 8.00771C14.9352 8.08897 15.0981 8.15274 15.43 8.18915C15.7807 8.22772 16.2372 8.22875 16.9287 8.22875H20.3147C20.7407 8.22875 21.0861 8.57415 21.0861 9.00018C21.0861 9.42621 20.7407 9.77161 20.3147 9.77161H16.888C16.2482 9.77161 15.7065 9.77161 15.2615 9.72275C14.7883 9.67081 14.3527 9.55777 13.9502 9.2853C13.5478 9.01283 13.2811 8.65036 13.057 8.23029C12.8464 7.83532 12.6452 7.33235 12.4076 6.73825C12.4026 6.7257 12.3976 6.71305 12.3925 6.7004L11.3698 4.14383C11.2116 3.74825 11.4041 3.2993 11.7996 3.14108Z"
        fill="#994C8E"
      />
      <path
        fillRule="evenodd"
        clipRule="evenodd"
        d="M3.67095 2.08416e-06H3.72299H9.18617C9.83726 -3.90587e-05 10.4049 -8.01023e-05 10.8609 0.0639999C11.3547 0.133418 11.8292 0.290995 12.2109 0.690101C12.5881 1.08437 12.7326 1.56621 12.7968 2.06582C12.8572 2.53546 12.8571 3.12271 12.8571 3.80806V14.1429C12.8571 14.5689 12.5117 14.9143 12.0857 14.9143H7.65839C7.23234 14.9143 6.88697 14.5689 6.88697 14.1429C6.88697 13.7168 7.23234 13.3714 7.65839 13.3714H11.3143V3.85715C11.3143 3.10895 11.3127 2.62208 11.2666 2.26261C11.2227 1.92195 11.1512 1.81417 11.096 1.75656C11.0455 1.70376 10.956 1.6354 10.6461 1.59184C10.3104 1.54465 9.85258 1.54286 9.13413 1.54286H3.72299C3.00453 1.54286 2.54676 1.54465 2.21103 1.59184C1.90114 1.6354 1.81164 1.70376 1.76114 1.75656C1.70604 1.81417 1.6344 1.92195 1.59059 2.26261C1.54436 2.62208 1.54286 3.10895 1.54286 3.85715V11.0571C1.54286 11.8053 1.54436 12.2923 1.59059 12.6516C1.6344 12.9924 1.70604 13.1001 1.76114 13.1577C1.81164 13.2106 1.90114 13.2789 2.21103 13.3225C2.54676 13.3697 3.00453 13.3714 3.72299 13.3714C4.14903 13.3714 4.49442 13.7168 4.49442 14.1429C4.49442 14.5689 4.14903 14.9143 3.72299 14.9143H3.67096C3.01986 14.9144 2.4522 14.9144 1.99628 14.8503C1.50243 14.7809 1.02796 14.6233 0.646212 14.2242C0.269076 13.83 0.124592 13.3481 0.0603374 12.8485C-6.02884e-05 12.3789 -2.94626e-05 11.7915 1.39453e-06 11.1062V3.85715C1.39453e-06 3.84074 1.39453e-06 3.82437 1.39453e-06 3.80807C-2.94626e-05 3.12271 -6.02884e-05 2.53546 0.0603374 2.06582C0.124592 1.56621 0.269076 1.08437 0.646212 0.690101C1.02796 0.290995 1.50243 0.133418 1.99628 0.0639999C2.4522 -8.01023e-05 3.01986 -3.90587e-05 3.67095 2.08416e-06Z"
        fill="#994C8E"
      />
    </svg>
  );
};

const Svg4 = () => {
  return (
    <svg
      width="20"
      height="20"
      viewBox="0 0 20 20"
      fill="none"
      xmlns="http://www.w3.org/2000/svg">
      <path
        d="M6.80659 19H3.32306C2.03976 19 1 17.9499 1 16.6539V9.75228C1.00078 9.2495 1.10794 8.7527 1.31428 8.29514C1.52063 7.83759 1.82141 7.42985 2.19647 7.09923L8.47529 1.57605C8.8981 1.20459 9.4396 1 10 1C10.5604 1 11.1019 1.20459 11.5247 1.57605L17.8035 7.1003C18.1785 7.4308 18.4792 7.83837 18.6855 8.29573C18.8918 8.75309 18.9991 9.24968 19 9.75228V16.6539C19 17.2759 18.7554 17.8725 18.32 18.3125C17.8845 18.7524 17.2939 18.9997 16.678 19H13.4835V11.9626C13.4835 10.9917 12.7042 10.2035 11.7418 10.2035H8.54941C7.58694 10.2035 6.80765 10.9917 6.80765 11.9626L6.80659 19ZM6.80659 19H13.4846"
        stroke="#115EFE"
        strokeWidth="2"
        strokeLinejoin="round"
      />
    </svg>
  );
};

const Svg5 = () => {
  return (
    <svg
      width="18"
      height="18"
      viewBox="0 0 18 18"
      fill="none"
      xmlns="http://www.w3.org/2000/svg">
      <path
        d="M14.2734 14.8008C16.3283 14.8008 18 13.1448 18 11.1094C18 9.90341 17.3996 8.78024 16.4279 8.09638C16.7647 7.58563 16.9453 6.98861 16.9453 6.36328C16.9453 5.00787 16.0585 3.81066 14.7844 3.3737C14.6077 1.48377 13.0269 0 11.1094 0C10.3479 0 9.612 0.234668 8.99497 0.666387C8.39763 0.24648 7.67211 0 6.89062 0C4.9731 0 3.39233 1.48377 3.21564 3.3737C1.94154 3.81066 1.05469 5.00787 1.05469 6.36328C1.05469 6.98861 1.23529 7.58563 1.57212 8.09638C0.600434 8.78024 0 9.90341 0 11.1094C0 13.1448 1.67171 14.8008 3.72656 14.8008H6.36328V16.9453H3.72656C3.43533 16.9453 3.19922 17.1814 3.19922 17.4727C3.19922 17.7639 3.43533 18 3.72656 18H14.2734C14.5647 18 14.8008 17.7639 14.8008 17.4727C14.8008 17.1814 14.5647 16.9453 14.2734 16.9453H11.6367V14.8008H14.2734ZM11.1094 1.05469C12.5517 1.05469 13.767 2.2449 13.7409 3.77009C13.7365 4.02465 13.9147 4.24603 14.1643 4.29616C15.1646 4.49715 15.8906 5.3665 15.8906 6.36328C15.8906 6.93158 15.6662 7.46522 15.2588 7.86586C14.996 8.12419 15.073 8.56635 15.4075 8.72068C16.3417 9.15173 16.9453 10.0894 16.9453 11.1094C16.9453 12.5633 15.7467 13.7461 14.2734 13.7461H12.6353C13.3202 13.0756 13.7461 12.1414 13.7461 11.1094C13.7461 9.90341 13.1457 8.78024 12.174 8.09638C12.5108 7.58563 12.6914 6.98861 12.6914 6.36328C12.6914 5.00618 11.8194 3.8102 10.5657 3.37461C10.4971 2.63781 10.215 1.96274 9.78272 1.41318C10.1826 1.18012 10.6391 1.05469 11.1094 1.05469ZM10.582 16.9453H7.41797V14.8008C7.93828 14.8008 10.2612 14.8008 10.582 14.8008V16.9453ZM10.0547 13.7461C9.7792 13.7461 7.67932 13.7461 7.41797 13.7461V10.2731L9.37287 8.31821C9.57881 8.11227 9.57881 7.77839 9.37287 7.57245C9.16696 7.3665 8.83304 7.3665 8.6271 7.57245L7.41797 8.78157V3.72656C7.41797 3.43533 7.18186 3.19922 6.89062 3.19922C6.59939 3.19922 6.36328 3.43533 6.36328 3.72656V6.6722L5.15412 5.46307C4.94821 5.25712 4.61429 5.25712 4.40835 5.46307C4.2024 5.66902 4.2024 6.00289 4.40835 6.20884L6.36328 8.16374V10.8909L5.15412 9.68179C4.94821 9.47584 4.61429 9.47584 4.40835 9.68179C4.2024 9.88773 4.2024 10.2216 4.40835 10.4276L6.36328 12.3825V13.7461H3.72656C2.25327 13.7461 1.05469 12.5633 1.05469 11.1094C1.05469 10.0894 1.65829 9.15173 2.59246 8.72072C2.927 8.56635 3.00396 8.12419 2.74124 7.86589C2.33378 7.46522 2.10938 6.93158 2.10938 6.36328C2.10938 5.3665 2.83539 4.49712 3.83572 4.29616C4.09078 4.24494 4.29205 4.00802 4.25405 3.69956C4.26836 2.23864 5.4456 1.05469 6.89062 1.05469C8.33565 1.05469 9.51289 2.23861 9.5272 3.69953C9.48955 4.00482 9.68752 4.24434 9.94553 4.29616C10.9255 4.49304 11.6367 5.36238 11.6367 6.36328C11.6367 6.93158 11.4123 7.46522 11.0049 7.86586C10.7421 8.12419 10.8191 8.56635 11.1536 8.72068C12.0878 9.15173 12.6914 10.0894 12.6914 11.1094C12.6914 12.5633 11.5086 13.7461 10.0547 13.7461Z"
        fill="#138C00"
      />
    </svg>
  );
};

const Svg6 = () => {
  return (
    <svg
      width="18"
      height="18"
      viewBox="0 0 18 18"
      fill="none"
      xmlns="http://www.w3.org/2000/svg">
      <path
        d="M9.02727 4.3823C9.35946 4.3823 9.62876 4.113 9.62876 3.78081C9.62876 3.44862 9.35946 3.17932 9.02727 3.17932C8.69508 3.17932 8.42578 3.44862 8.42578 3.78081C8.42578 4.113 8.69508 4.3823 9.02727 4.3823Z"
        fill="#A30000"
      />
      <path
        d="M16.5495 6.78765H1.45335C0.781485 6.78765 0.216687 6.35037 0.0482703 5.70016C-0.120146 5.04995 0.16135 4.39372 0.749005 4.06772L7.24929 0.456981C8.34641 -0.151725 9.65585 -0.152928 10.7542 0.456981L17.2545 4.06832C17.8421 4.39433 18.123 5.05055 17.9546 5.70076C17.7862 6.35097 17.2214 6.78765 16.5495 6.78765ZM9.00143 1.20403C8.60024 1.20403 8.19904 1.30568 7.83334 1.50838L1.33305 5.11972C1.18689 5.20152 1.19531 5.32964 1.21335 5.39881C1.2308 5.46858 1.28613 5.58527 1.45335 5.58527H16.5495C16.7167 5.58527 16.7721 5.46919 16.7901 5.39881C16.8076 5.32964 16.816 5.20092 16.6704 5.11972L10.1701 1.50838C9.80442 1.30568 9.40322 1.20403 9.00143 1.20403Z"
        fill="#A30000"
      />
      <path
        d="M3.2373 7.99066H4.44028V14.9926H3.2373V7.99066Z"
        fill="#A30000"
      />
      <path
        d="M10.1348 7.99066H11.3377V14.9926H10.1348V7.99066Z"
        fill="#A30000"
      />
      <path
        d="M6.7168 7.99066H7.91977V14.9926H6.7168V7.99066Z"
        fill="#A30000"
      />
      <path
        d="M13.5635 7.99066H14.7665V14.9926H13.5635V7.99066Z"
        fill="#A30000"
      />
      <path
        d="M16.5594 18H1.44223C0.840141 18 0.331281 17.609 0.176699 17.0268C0.0215145 16.4445 0.268726 15.8527 0.79142 15.5531L1.65275 15.0617C2.42025 14.6232 3.29361 14.3917 4.176 14.3917H13.8239C14.7069 14.3917 15.5796 14.6232 16.3471 15.0617L17.2078 15.5531C17.7311 15.8521 17.979 16.4445 17.8238 17.0268C17.6692 17.609 17.1603 18 16.5582 18H16.5594ZM1.3893 16.5973C1.36644 16.6106 1.31832 16.6382 1.33938 16.7176C1.36043 16.797 1.41577 16.797 1.44223 16.797H16.5594C16.5859 16.797 16.6418 16.797 16.6629 16.7176C16.684 16.6382 16.6352 16.6106 16.6124 16.5973L15.7516 16.1059C15.1652 15.7709 14.4993 15.594 13.8251 15.594H4.1772C3.50293 15.594 2.83648 15.7709 2.25063 16.1059L1.3893 16.5973Z"
        fill="#A30000"
      />
      <path
        d="M14.2921 8.59216H3.15792C2.24727 8.59216 1.50684 7.85173 1.50684 6.94168V5.58472H15.9426V6.94168C15.9426 7.85173 15.2021 8.59216 14.2921 8.59216ZM2.70981 6.78769V6.94168C2.70981 7.18829 2.91071 7.38918 3.15792 7.38918H14.2921C14.5387 7.38918 14.7396 7.18829 14.7396 6.94168V6.78769H2.70981Z"
        fill="#A30000"
      />
    </svg>
  );
};

const EnergyConsumption = () => {
  const { language } = useParams();
  const [data, setData] = useState([]);

  const widgets = useMemo(
    () => [
      {
        name_ge: "მრეწველობა",
        name_en: "Industry",
        legendCode: 44,
        svg: <Svg1 />,
        unit_ge: "პროცენტი",
        unit_en: "percent",
      },
      {
        name_ge: "მშენებლობა",
        name_en: "Construction",
        legendCode: 49,
        svg: <Svg2 />,
        unit_ge: "პროცენტი",
        unit_en: "percent",
      },
      {
        name_ge: "ტრანსპორტი",
        name_en: "Transport",
        legendCode: 45,
        svg: <Svg3 />,
        unit_ge: "პროცენტი",
        unit_en: "percent",
      },
      {
        name_ge: "შინამეურნეობები",
        name_en: "Residential",
        legendCode: 46,
        svg: <Svg4 />,
        unit_ge: "პროცენტი",
        unit_en: "percent",
      },
      {
        name_ge: "კერძო და სახელმწიფო მომსახურება",
        name_en: "Commercial and Public Services",
        legendCode: 47,
        svg: <Svg6 />,
        unit_ge: "პროცენტი",
        unit_en: "percent",
      },
      {
        name_ge: "სოფლის, სატყეო და თევზის მეურნეობა",
        name_en: "Agriculture, Forestry and Fishing",
        legendCode: 48,
        svg: <Svg5 />,
        unit_ge: "პროცენტი",
        unit_en: "percent",
      },
      {
        name_ge: "სხვა",
        name_en: "Other",
        legendCode: 50,
        unit_ge: "პროცენტი",
        unit_en: "percent",
      },
    ],
    []
  );

  useEffect(() => {
    const fetchData = async () => {
      try {
        const allData = await Promise.all(
          widgets.map(async (widget) => {
            const response = await fetch(
              `${backEndUrl}/api/energyConsumptionBySector/${widget.legendCode}`
            );

            if (!response.ok) {
              throw new Error("Network response was not ok");
            }
            const rawData = await response.json();

            return {
              name_ge: widget.name_ge,
              name_en: widget.name_en,
              data: rawData,
            };
          })
        );

        setData(allData);
      } catch (error) {
        console.log("Fetch error:", error);
      }
    };

    fetchData();
  }, [widgets]);

  return (
    <div className="widget-container">
      {data.map((widgetData, index) => {
        const currentName = widgetData[`name_${language}`];

        // Find matching widget to get svg and unit
        const isNameInWidgets = widgets.find(
          (widget) => widget[`name_${language}`] === currentName
        );

        // Dynamically determine the last year from the data
        const itemData = widgetData.data[0];
        const yearKeys = Object.keys(itemData).filter((key) =>
          key.startsWith("y_")
        );
        const years = yearKeys.map((key) => parseInt(key.slice(2), 10));
        const lastYear = Math.max(...years);

        const value = itemData[`y_${lastYear}`];

        return (
          <div className="widget-wrapper" key={index}>
            <div className="top">
              {isNameInWidgets?.svg}
              <h3>{currentName}</h3>
            </div>
            <div className="middle">
              <h2>
                <AnimatedNumber targetValue={value} duration={1000} />
              </h2>
              <h3>{isNameInWidgets[`unit_${language}`]}</h3>
            </div>
          </div>
        );
      })}
    </div>
  );
};

export default EnergyConsumption;
